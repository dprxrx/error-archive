<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Error Archive - ID/PW ì°¾ê¸°</title>

  <link rel="stylesheet" href="assets/css/base.css">
  <link rel="stylesheet" href="assets/css/layout.css">
  <link rel="stylesheet" href="assets/css/form.css">
</head>
<body>

  <div class="main-container">
    <div class="logo-box">
      <img src="assets/logo_img.png" alt="Error Archive Logo" class="logo">
    </div>

    <div class="card-box find-box">
      <input type="radio" id="tab-id" name="tab" checked>
      <input type="radio" id="tab-pw" name="tab">

      <div class="tab-header">
        <label for="tab-id" class="tab-label">ID ì°¾ê¸°</label>
        <label for="tab-pw" class="tab-label">PW ì°¾ê¸°</label>
      </div>

      <!-- âœ… ID ì°¾ê¸° -->
      <div class="tab-content" id="content-id">
        <form id="form-find-id">
          <label for="find-email">ì´ë©”ì¼ ì…ë ¥</label>
          <input type="email" id="find-email" name="find-email" placeholder="ì´ë©”ì¼ ì…ë ¥">
          <div id="error-id"></div>
          <button type="button" class="btn-primary" id="btn-find-id">ID ì°¾ê¸°</button>
        </form>
        <div class="sub-links">
          <a href="index">ë¡œê·¸ì¸ í•˜ê¸°</a>
        </div>
      </div>

      <!-- âœ… PW ì°¾ê¸° -->
      <div class="tab-content" id="content-pw">
        <form id="form-find-pw">
          <label for="find-id">ID ì…ë ¥</label>
          <input type="text" id="find-id" name="find-id" placeholder="ì•„ì´ë”” ì…ë ¥">

          <label for="find-email2">ì´ë©”ì¼ ì…ë ¥</label>
          <input type="email" id="find-email2" name="find-email2" placeholder="ì´ë©”ì¼ ì…ë ¥">
          <div id="error-pw"></div>
          <button type="button" class="btn-primary" id="btn-find-pw">PW ì°¾ê¸°</button>
        </form>
        <div class="sub-links">
          <a href="index">ë¡œê·¸ì¸ í•˜ê¸°</a>
        </div>
      </div>
    </div>
  </div>

  <script>

    /* âœ… ID ì°¾ê¸° ë²„íŠ¼ í´ë¦­ */
    document.getElementById("btn-find-id").addEventListener("click", async () => {
      const email = document.getElementById("find-email").value.trim();
      const errorBox = document.getElementById("error-id");
      errorBox.innerHTML = "";

      if (!email) {
        showError(errorBox, "ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      try {
        const res = await fetch(`/api/find_id`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ "find-email": email })
        });
        const data = await res.json();
        alert(data.message);
      } catch (err) {
        alert("ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        console.error(err);
      }
    });

    /* âœ… PW ì°¾ê¸° ë²„íŠ¼ í´ë¦­ */
    document.getElementById("btn-find-pw").addEventListener("click", async () => {
      const idVal = document.getElementById("find-id").value.trim();
      const emailVal = document.getElementById("find-email2").value.trim();
      const errorBox = document.getElementById("error-pw");
      errorBox.innerHTML = "";

      // ğŸ”¸ ì„¸ ê°€ì§€ ê²½ìš°ë¡œ êµ¬ë¶„
  if (!idVal && !emailVal) {
    showError(errorBox, "ì•„ì´ë””ì™€ ì´ë©”ì¼ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  } else if (!idVal) {
    showError(errorBox, "ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  } else if (!emailVal) {
    showError(errorBox, "ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }


      try {
        const res = await fetch(`/api/find_pw`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            "find-id": idVal,
            "find-email2": emailVal
          })
        });
        const data = await res.json();
        alert(data.message);
      } catch (err) {
        alert("ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        console.error(err);
      }
    });

    // ê³µí†µ ì˜¤ë¥˜ ì¶œë ¥ í•¨ìˆ˜
    function showError(container, msg) {
      const div = document.createElement("div");
      div.className = "error-msg";
      div.textContent = msg;
      container.appendChild(div);
    }
  </script>

</body>
</html>


