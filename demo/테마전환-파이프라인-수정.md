# 테마 전환 파이프라인 수정 가이드

## 문제 상황

`frontend-pipeline-ci` 파이프라인이 SonarQube를 포함하도록 수정되어, 테마 전환 시나리오에서 파이프라인 검증 실패가 발생했습니다.

## 해결 방법

테마 전환용 별도 파이프라인(`frontend-pipeline-ci-theme`)을 생성했습니다.

### 1단계: 테마 전환 파이프라인 배포

```bash
kubectl apply -f tekton/pipelines/frontend-pipeline-ci-theme.yaml
```

### 2단계: 파이프라인 확인

```bash
kubectl get pipeline frontend-pipeline-ci-theme -n default
```

### 3단계: 테마 전환 시나리오 실행

이제 테마 전환 시나리오는 `frontend-pipeline-ci-theme` 파이프라인을 사용합니다.

- `demo/WINTER-CICD-복붙.md` - 겨울 테마 전환
- `demo/AUTUMN-CICD-복붙.md` - 가을 테마 전환
- `demo/COPY-PASTE-COMMANDS.md` - 가을/겨울 전환

## 파이프라인 차이점

### frontend-pipeline-ci (SonarQube 포함)
- SonarQube 스캔 단계 포함
- 코드 품질 검사 후 빌드
- 일반적인 CI/CD 시나리오용

### frontend-pipeline-ci-theme (SonarQube 없음)
- SonarQube 스캔 단계 없음
- 바로 빌드 및 푸시
- 테마 전환 시나리오 전용

## 테마 전환 명령어 (업데이트됨)

### 겨울 테마 전환
```bash
IMAGE_TAG="winter-$(date +%Y%m%d-%H%M%S)"
kubectl create -f - <<EOF
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  generateName: frontend-winter-theme-
  namespace: default
spec:
  pipelineRef:
    name: frontend-pipeline-ci-theme
  params:
  - name: git-url
    value: https://github.com/dprxrx/error-archive.git
  - name: git-revision
    value: main
  - name: docker-image
    value: 192.168.0.169:443/project/error-archive-frontend:$IMAGE_TAG
  - name: registry-url
    value: 192.168.0.169:443
  - name: registry-username
    value: admin
  - name: registry-password
    value: Harbor12345
  workspaces:
  - name: shared-workspace
    volumeClaimTemplate:
      spec:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: 1Gi
EOF
```

### 가을 테마 전환
```bash
IMAGE_TAG="autumn-$(date +%Y%m%d-%H%M%S)"
kubectl create -f - <<EOF
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  generateName: frontend-autumn-theme-
  namespace: default
spec:
  pipelineRef:
    name: frontend-pipeline-ci-theme
  params:
  - name: git-url
    value: https://github.com/dprxrx/error-archive.git
  - name: git-revision
    value: main
  - name: docker-image
    value: 192.168.0.169:443/project/error-archive-frontend:$IMAGE_TAG
  - name: registry-url
    value: 192.168.0.169:443
  - name: registry-username
    value: admin
  - name: registry-password
    value: Harbor12345
  workspaces:
  - name: shared-workspace
    volumeClaimTemplate:
      spec:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: 1Gi
EOF
```

## 확인

```bash
# 파이프라인 목록 확인
kubectl get pipelines -n default | grep frontend

# 테마 전환 파이프라인 확인
kubectl get pipeline frontend-pipeline-ci-theme -n default

# 최근 PipelineRun 확인
kubectl get pipelineruns -n default --sort-by=.metadata.creationTimestamp | tail -5
```

